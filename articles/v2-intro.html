<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Introduction to supercells • supercells</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to supercells">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">supercells</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.9.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><h6 class="dropdown-header" data-toc-skip>Version 2.0</h6></li>
    <li><a class="dropdown-item" href="../articles/v2-changes-since-v1.html">Main supercells changes since version 1.0.0</a></li>
    <li><a class="dropdown-item" href="../articles/v2-intro.html">Introduction to supercells</a></li>
    <li><a class="dropdown-item" href="../articles/v2-tuning.html">Choosing Parameters for Supercells</a></li>
    <li><a class="dropdown-item" href="../articles/v2-evaluation.html">Evaluation and diagnostics</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Version 1.0</h6></li>
    <li><a class="dropdown-item" href="../articles/v1-main-function.html">The supercells() function</a></li>
    <li><a class="dropdown-item" href="../articles/v1-benchmarks.html">Benchmarks</a></li>
    <li><a class="dropdown-item" href="../articles/v1-one_var.html">Superpixels of a single raster layer</a></li>
    <li><a class="dropdown-item" href="../articles/v1-rgb_vars.html">Superpixels of an RGB raster</a></li>
    <li><a class="dropdown-item" href="../articles/v1-motifels.html">Superpixels of spatial categorical patterns</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Nowosad/supercells/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Introduction to supercells</h1>
                        <h4 data-toc-skip class="author">Jakub
Nowosad</h4>
            
            <h4 data-toc-skip class="date">2026-02-06</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/Nowosad/supercells/blob/main/vignettes/articles/v2-intro.Rmd" class="external-link"><code>vignettes/articles/v2-intro.Rmd</code></a></small>
      <div class="d-none name"><code>v2-intro.Rmd</code></div>
    </div>

    
    
<p>The <strong>supercells</strong> package creates compact, homogeneous
regions from raster data. It replaces thousands or millions of pixels
with a smaller number of meaningful spatial units. This helps with
interpretation, visualization, and downstream modeling. It also reduces
noise while preserving important spatial structure.</p>
<p>The package is designed to work with rasters that have many layers or
time steps. It supports multiple distance measures such as
Jensen–Shannon divergence or dynamic time warping, as well as
user-defined distance functions, so similarity can be adapted to the
data. It can therefore handle diverse data types and high-dimensional
inputs without changing the main workflow. The package core ideas are
described in <span class="citation">Nowosad and Stepinski
(2022)</span>.</p>
<div class="section level2">
<h2 id="core-functions">Core functions<a class="anchor" aria-label="anchor" href="#core-functions"></a>
</h2>
<p>The main function in the package is <code><a href="../reference/sc_slic.html">sc_slic()</a></code>. It
implements a SLIC-style algorithm that balances spatial compactness with
value similarity <span class="citation">(Achanta et al. 2012)</span> and
extends it to work with multi-layer rasters and custom distance
functions. The output is a set of polygon supercells stored as an
<code>sf</code> object. This object can include centers, average values,
and IDs depending on the requested outcomes. In practice,
<code><a href="../reference/sc_slic.html">sc_slic()</a></code> is the entry point for most workflows.</p>
<p>The key tuning arguments in <code><a href="../reference/sc_slic.html">sc_slic()</a></code> are
<code>step</code> and <code>compactness</code>. <code>step</code> sets
the spacing of initial centers and controls the expected number of
supercells. It can be thought of as the expected spatial scale of the
output. <code>compactness</code> controls the tradeoff between spatial
regularity and value similarity. Lower values prioritize value
similarity and may lead to irregular shapes, while higher values
prioritize shape regularity – supercells may look more like squares –
but may be less homogeneous in terms of values.</p>
<p>For compactness selection, you may use
<code><a href="../reference/sc_tune_compactness.html">sc_tune_compactness()</a></code> to estimate a good value from a short
pilot run. Alternatively, the <code>"auto"</code> option for
<code>compactness</code> enables SLIC0-style adaptive compactness when
you want the algorithm to adjust locally – this does not require setting
a specific value, but also takes away direct control.</p>
<p>To assess quality of the resulting supercells, use
<code><a href="../reference/sc_metrics_pixels.html">sc_metrics_pixels()</a></code> for pixel-level distances,
<code><a href="../reference/sc_metrics_supercells.html">sc_metrics_supercells()</a></code> for per-supercell summaries, and
<code><a href="../reference/sc_metrics_global.html">sc_metrics_global()</a></code> for a general overview. These metrics
help compare different parameter settings or input preprocessing
choices.</p>
</div>
<div class="section level2">
<h2 id="minimal-example">Minimal example<a class="anchor" aria-label="anchor" href="#minimal-example"></a>
</h2>
<p>The goal of this example is to derive supercells from a raster and
visualize them. For that purpose, we will use the built-in
<code>volcano</code> dataset, which is a small raster of elevation
values.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://jakubnowosad.com/supercells/">supercells</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/" class="external-link">terra</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">vol</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"raster/volcano.tif"</span>, package <span class="op">=</span> <span class="st">"supercells"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>This raster has 5307 cells – a small number for demonstration, but
the same workflow applies to much larger rasters as well. Moreover, it
has only one layer – but the same functions can handle multi-layer
rasters with any number of layers.</p>
<p>Below, we create supercells in three different formats: polygons,
points, and raster IDs. The polygon supercells are the most common
output. Here, we specified <code>step = 8</code> which would result in
supercells of approximately 8x8 cells in size if they were perfectly
regular, but the actual shapes and sizes will depend on the data and the
<code>compactness</code> setting. The compactness is set to
<code>1</code> – the behavior of this parameter depends on many factors,
including the range of values in the raster, their properties, and the
selected distance measure.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Polygon supercells (sf)</span></span>
<span><span class="va">vol_sc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sc_slic.html">sc_slic</a></span><span class="op">(</span></span>
<span>  <span class="va">vol</span>,</span>
<span>  step <span class="op">=</span> <span class="fl">8</span>,</span>
<span>  compactness <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">vol</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_geometry</a></span><span class="op">(</span><span class="va">vol_sc</span><span class="op">)</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, lwd <span class="op">=</span> <span class="fl">0.6</span>, border <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code></pre></div>
<p><img src="v2-intro_files/figure-html/unnamed-chunk-3-1.png" class="r-plt" alt="" width="700"></p>
<p>The resulting <code>sf</code> object contains one row per supercell.
Each row stores summary values of each layer in the original raster, as
well as the geometry of the supercell. By default only summary values
are returned, so use
<code>outcomes = c("supercells", "coordinates", "values")</code> when
you also want IDs and center coordinates.</p>
<p>Two related functions provide alternative output formats. Use
<code><a href="../reference/sc_slic_points.html">sc_slic_points()</a></code> to return only supercell centers as
points. Use <code><a href="../reference/sc_slic_raster.html">sc_slic_raster()</a></code> to return a raster of
supercell IDs for large datasets or raster-based pipelines. These
functions share the same core arguments and can be swapped with minimal
changes.</p>
<p>Now, let’s try to tune the <code>compactness</code> parameter using a
pilot run.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tune</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sc_tune_compactness.html">sc_tune_compactness</a></span><span class="op">(</span></span>
<span>  <span class="va">vol</span>,</span>
<span>  step <span class="op">=</span> <span class="fl">8</span>,</span>
<span>  metrics <span class="op">=</span> <span class="st">"local"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">tune</span></span>
<span><span class="co">#&gt;   step metric compactness</span></span>
<span><span class="co">#&gt; 1    8  local    9.084872</span></span></code></pre></div>
<p>Next, we may try to create supercells with the suggested
<code>compactness</code> value.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vol_sc_tuned</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sc_slic.html">sc_slic</a></span><span class="op">(</span></span>
<span>  <span class="va">vol</span>,</span>
<span>  step <span class="op">=</span> <span class="fl">8</span>,</span>
<span>  compactness <span class="op">=</span> <span class="va">tune</span><span class="op">$</span><span class="va">compactness</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">vol</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_geometry</a></span><span class="op">(</span><span class="va">vol_sc_tuned</span><span class="op">)</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, lwd <span class="op">=</span> <span class="fl">0.6</span>, border <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code></pre></div>
<p><img src="v2-intro_files/figure-html/unnamed-chunk-5-1.png" class="r-plt" alt="" width="700"></p>
<p>Such a derived compactness value may serve as a good starting point
for further experimentation.</p>
<p>Afterwards, we can evaluate the quality of the resulting supercells
using metrics on different levels.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pixel_metrics</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sc_metrics_pixels.html">sc_metrics_pixels</a></span><span class="op">(</span><span class="va">vol</span>, <span class="va">vol_sc_tuned</span><span class="op">)</span></span>
<span><span class="va">supercell_metrics</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sc_metrics_supercells.html">sc_metrics_supercells</a></span><span class="op">(</span><span class="va">vol</span>, <span class="va">vol_sc_tuned</span><span class="op">)</span></span>
<span><span class="va">global_metrics</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sc_metrics_global.html">sc_metrics_global</a></span><span class="op">(</span><span class="va">vol</span>, <span class="va">vol_sc_tuned</span><span class="op">)</span></span></code></pre></div>
<p>The pixel-level metrics show how well the supercells represent the
original raster values at the pixel level. By default they include
<code>spatial</code>, <code>value</code>, <code>combined</code>, and
<code>balance</code>. When <code>scale = TRUE</code> (the default), the
spatial and value layers are returned as <code>spatial_scaled</code> and
<code>value_scaled</code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pixel_metrics</span>, nr <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="v2-intro_files/figure-html/unnamed-chunk-7-1.png" class="r-plt" alt="" width="700"></p>
<p>These maps help diagnose where spatial or value coherence is weak.
For example, large patches of high values can indicate areas where the
chosen parameters may be too coarse for local variation.</p>
<p>The supercell-level metrics summarize each polygon as a single value.
These are helpful when you want to compare supercells or join metrics to
attributes.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">supercell_metrics</span><span class="op">)</span></span></code></pre></div>
<p><img src="v2-intro_files/figure-html/unnamed-chunk-8-1.png" class="r-plt" alt="" width="700"></p>
<p>The global metrics provide a single-row summary of overall quality.
They are useful for comparing parameter settings across multiple runs,
such as a small grid of <code>step</code> and <code>compactness</code>
values.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">global_metrics</span></span>
<span><span class="co">#&gt;   step compactness n_supercells mean_spatial_dist_scaled mean_value_dist_scaled</span></span>
<span><span class="co">#&gt; 1    8    9.084872           88                0.4546412              0.3061439</span></span>
<span><span class="co">#&gt;   mean_combined_dist    balance</span></span>
<span><span class="co">#&gt; 1          0.5915118 -0.4036551</span></span></code></pre></div>
<!-- 
# Where to go next

See `v2-workflows` for end-to-end usage patterns and practical recipes.
See `v2-tuning` for guidance on choosing `compactness` and related settings.
See `v2-evaluation` for metrics and diagnostics that help compare results.
See `v2-benchmarks` for performance notes and scaling behavior.
See `v2-changes-since-v1` for a concise summary of recent updates. -->
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-achanta2012slic" class="csl-entry">
Achanta, Radhakrishna, Appu Shaji, Kevin Smith, Aurelien Lucchi, Pascal
Fua, and Sabine Süsstrunk. 2012. <span>“SLIC Superpixels Compared to
State-of-the-Art Superpixel Methods.”</span> <em>IEEE Transactions on
Pattern Analysis and Machine Intelligence</em> 34 (11): 2274–82.
</div>
<div id="ref-Nowosad2022" class="csl-entry">
Nowosad, Jakub, and Tomasz F. Stepinski. 2022. <span>“Extended
<span>SLIC</span> Superpixels Algorithm for Applications to Non-Imagery
Geospatial Rasters.”</span> <em>International Journal of Applied Earth
Observation and Geoinformation</em> 112 (August): 102935. <a href="https://doi.org/10.1016/j.jag.2022.102935" class="external-link">https://doi.org/10.1016/j.jag.2022.102935</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jakub Nowosad.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
