% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/sc_tune_compactness.R
\name{sc_tune_compactness}
\alias{sc_tune_compactness}
\title{Estimate compactness from a light SLIC run}
\usage{
sc_tune_compactness(
  raster,
  step = NULL,
  compactness = 1,
  dist_fun = "euclidean",
  avg_fun = "mean",
  clean = TRUE,
  minarea,
  iter = 1,
  k = NULL,
  centers = NULL,
  sample_size = 10000,
  value_scale = "auto"
)
}
\arguments{
\item{raster}{A \code{SpatRaster}.}

\item{step}{The distance (number of cells) between initial centers (alternative is \code{k}).}

\item{compactness}{Starting compactness for the pilot run.}

\item{dist_fun}{A distance function name or a custom function. Supported names:
"euclidean", "jsd", "dtw", "dtw2d", or any method from \code{philentropy::getDistMethods()}.
A custom function must accept two numeric vectors and return a single numeric value.}

\item{avg_fun}{An averaging function name or custom function used to summarize
values within each supercell. Supported names: "mean" and "median". A custom
function must accept a numeric vector and return a single numeric value.}

\item{clean}{Should connectivity of the supercells be enforced?}

\item{minarea}{Minimal size of a supercell (in cells).}

\item{iter}{Number of SLIC iterations for the pilot run.}

\item{k}{The number of supercells desired (alternative to \code{step}).}

\item{centers}{Optional sf object of custom centers. Requires \code{step}.}

\item{sample_size}{Optional limit on the number of pixels used for the summary
(passed to \code{terra::global()} as \code{maxcell}).}

\item{value_scale}{Optional scale factor applied to the median value distance
before computing compactness. Use \code{"auto"} to divide by
\code{sqrt(nlyr(raster))} (useful for high-dimensional embeddings). Default: \code{"auto"}.}
}
\value{
A one-row data frame with columns \code{step}, \code{median_value_dist},
\code{median_spatial_dist}, and \code{compactness}.
}
\description{
Runs a short SLIC segmentation (default \code{iter = 1}) and uses cell-level
distances to estimate a compactness value where value and spatial distances
are balanced for the chosen \code{step}.
Summaries are cell-weighted medians over the (sampled) cells.
}
\examples{
library(terra)
vol = rast(system.file("raster/volcano.tif", package = "supercells"))
tune = sc_tune_compactness(vol, step = 8)
tune$compactness

}
\seealso{
\code{\link[=sc_slic]{sc_slic()}}
}
